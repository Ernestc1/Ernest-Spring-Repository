package textExcel;

public class FormulaCell extends RealCell{
	private String formula;
	public FormulaCell (String input){
		super(input);
		formula = input;
	}
	public String abbreviatedCellText(){
		double result = getDoubleValue();
		return (result + "               ").substring(0, 10);
	}
	public String fullCellText(){
		return super.fullCellText();
	}
	public double getDoubleValue(){
		formula = formula.substring(1, formula.length()-1);
		String [] splitFormula = formula.split(" ");
		double result = 0.0;
		int operator = 2;
		for(int i = 0; i < splitFormula.length - 1; i++){
			if(splitFormula[operator].equals(("*"))){
				double firstNum = Double.parseDouble(splitFormula[i + 1]);
				double secondNum = Double.parseDouble(splitFormula[i + 3]);
				result += firstNum * secondNum;
				operator += 2;
			} else if (splitFormula[operator].equals(("+"))){
				double firstNum = Double.parseDouble(splitFormula[i + 1]);
				double secondNum = Double.parseDouble(splitFormula[i + 3]);
				result += firstNum + secondNum;
				operator += 2;
			} else if (splitFormula[operator].equals(("-"))){
				double firstNum = Double.parseDouble(splitFormula[i]);
				double secondNum = Double.parseDouble(splitFormula[i + 3]);
				result += firstNum - secondNum;
				operator +=2;
			} 
			else if (splitFormula[operator].equals(("/"))){
				double firstNum = Double.parseDouble(splitFormula[i]);
				double secondNum = Double.parseDouble(splitFormula[i + 2]);
				result += firstNum / secondNum;
				operator += 2;
			} 
		}
		return result;
	}
	/*  [5.4,+,3.8,*,1.3]
	 * 
	 */
	
}

